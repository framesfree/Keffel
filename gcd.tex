\documentclass{standalone}
%\documentclass[convert={density=600,size=1080x800,outext=.png}]{standalone}
\NeedsTeXFormat{LaTeX2e}
\usepackage{tikz}
\usepackage[utf8]{inputenc}
\usepackage{wasysym}
\usepackage{gensymb}
\usepackage{ifthen}
\usepackage{pgf}
% \usepackage{fontspec}

% booleans:
\newboolean{passivated}
\newboolean{thin_window}
\newboolean{show_legendbox}

%\input{crystals/003_korea_1902.txt}
% \input{input_GCD.tex} % test input
 \input{input_GFD.tex} % test input
\newcommand\Scale{3} % <--- Scale (do NOT change if you are not shure what is it!)
\newcommand\Diam{\Dia/\Scale} % Detector diameter in mm
\newcommand\Height{\Hei/\Scale} % Detector hight in mm
\newcommand\WO{\Gdt/\Scale} % Groove depth
\newcommand\Bullet{\Bult/\Scale} %widow bulletization
\newcommand\FCD{\Cdiam/\Scale} %Contact diam 
\newcommand\CDepth{\Cdepth/\Scale} %Cont depth
\newcommand\GrooveExt{\GrvEx/\Scale} %Groove ext. diameter
\newcommand\GrooveInt{\GrvIn/\Scale} %Groove int. diameter

\tikzset{ % styles for layers
  arrow/.style={<->,>=latex,thin,gray,every rectangle node/.style={fill=white,midway,font=\sffamily}},
  dimen/.style={thin,gray},
  caption/.style={font=\sffamily,black,scale=1.3},
  lithium/.style={rounded corners,red!90!white,line width=2pt},
  germanium/.style={rounded corners,black!80,line width=1pt},
  passiv/.style={rounded corners,violet!60!white,line width=3pt},
  in_window/.style={rounded corners,blue,line width=1pt},
}
\begin{document}

    
\resizebox{1200px}{!}{ %<---YOU CAN SET IMAGE SIZE IN PIXELS HERE!
\begin{tikzpicture}[thick,scale=0.8, every node/.style={scale=0.8}]
% Back fill
    \draw[rounded corners, top color=gray!5!white, bottom color=black!60!blue!15,draw=none] (0,-\Height) -- (0,-\Bullet) --
    (\Bullet,0) -- (\Diam-\Bullet,0) -- (\Diam,-\Bullet) -- (\Diam,-\Height) -- cycle;
    \draw[gray!45, line width=0.5pt] (\Diam/2 - \FCD/2,-\Height) -- (\Diam/2 + \FCD /2,-\Height);
    \draw[gray!45, line width=0.5pt] (\Diam/2 +\GrooveExt/2,-\Height) -- (\Diam/2 + \FCD /2,-\Height);
    \draw[gray!45, line width=0.5pt] (\Diam/2 -\GrooveExt/2,-\Height) -- (\Diam/2 - \FCD /2,-\Height);
% ---
    \draw[lithium] (\Diam/2-\GrooveExt/2,-\Height) -- (0,-\Height) -- (0,-\Bullet) -- %Left wall
    (\Bullet,0); %bulletize left
    \draw[lithium] (\Diam/2+\GrooveExt/2,-\Height) -- (\Diam,-\Height) -- (\Diam,-\Bullet)-- %Right wall
    (\Diam-\Bullet,0); %bulletize right
    \ifthenelse{\boolean{thin_window}}
      {  \draw[in_window] (\Bullet,0) -- (\Diam-\Bullet,0);} % thin window
      {  \draw[lithium] (\Bullet,0) -- (\Diam-\Bullet,0);} % window with Li layer 

    \ifthenelse{\boolean{passivated}}
      {
        \draw[passiv] (\Diam/2 +\GrooveExt/2,-\Height) -- (\Diam/2 +\GrooveExt/2,-\Height+\WO) -- 
        (\Diam/2 +\GrooveInt/2,-\Height+\WO) -- (\Diam/2 +\GrooveInt/2,-\Height) -- (\Diam/2 + \FCD /2,-\Height);  %Groove right
        \draw[passiv] (\Diam/2 -\GrooveExt/2,-\Height) -- (\Diam/2 -\GrooveExt/2,-\Height+\WO) -- 
        (\Diam/2 -\GrooveInt/2,-\Height+\WO) -- (\Diam/2 -\GrooveInt/2,-\Height) -- (\Diam/2 - \FCD /2,-\Height);  %Groove left
        \draw[arrow, ->] (\Diam/2*1.8,-\Height*1.2) -- (\Diam/2+\GrooveInt/2,-\Height+\WO/2);
      }
      {
        \draw[germanium] (\Diam/2 +\GrooveExt/2,-\Height) -- (\Diam/2 +\GrooveExt/2,-\Height+\WO) -- 
        (\Diam/2 +\GrooveInt/2,-\Height+\WO) -- (\Diam/2 +\GrooveInt/2,-\Height) -- (\Diam/2 + \FCD /2,-\Height);  %Groove right
        \draw[germanium] (\Diam/2 -\GrooveExt/2,-\Height) -- (\Diam/2 -\GrooveExt/2,-\Height+\WO) -- 
        (\Diam/2 -\GrooveInt/2,-\Height+\WO) -- (\Diam/2 -\GrooveInt/2,-\Height) -- (\Diam/2 - \FCD /2,-\Height);  %Groove left
      }
      \ifthenelse{\equal{\Dtype}{coax}}{
      \draw[in_window] (\Diam/2 - \FCD/2,-\Height) -- (\Diam/2 - \FCD/2,-\Height + \Cdepth/\Scale) -- 
      (\Diam/2 + \FCD /2,-\Height + \Cdepth/\Scale) -- (\Diam/2 + \FCD /2,-\Height);}{} %Contact hole
      
      \ifthenelse{\equal{\Dtype}{flat}}{
      \filldraw[fill=blue!40!white, draw=none] (\Diam/2 - \FCD /2,-\Height) rectangle (\Diam/2 + \FCD /2,-\Height + 0.2/\Scale);}{} % Flat contact
    \draw[gray,thin,dashed,opacity=5] (\Diam/2,\Height/15) -- (\Diam/2,-\Height - \Height/15); %Symmetry line
    %--------Captions--------
    \ifthenelse{\equal{\Dtype}{coax}}{
      \draw (\Diam/2 - \FCD/2 -0.6/\Scale, -\Height + \Cdepth/\Scale/2)node[caption,anchor=center,rotate=90]{\footnotesize Central contact (\char`\~ 0.3 $\mu$m)};}{}
      \ifthenelse{\equal{\Dtype}{flat}}{
      \draw (\Diam/2, -\Height)node[caption,anchor=north]{\small Flat contact $\diameter$\pgfmathparse{int(\Cdiam)}\pgfmathresult};}{}
    \draw (0, -\Height*0.5) node[caption,anchor=south,rotate=90]{\small Li diffusion (\char`\~ 700 $\mu$m)};
    \draw (\Diam/5, -\Height/1.2) node[caption,anchor=south]{P-type Germanium};
    \ifthenelse{\boolean{passivated}}{ \draw (\Diam/2*1.8,-\Height*1.2) node [caption,anchor=west]{Passivation coating};}{}
    \ifthenelse{\boolean{thin_window}}{\draw (\Diam/2,0) node[caption,anchor=south]{\small Thin window (\char`\~ 0.3 $\mu$m)};}{}
    %--------Dimensions--------
    \draw[dimen] (0,-\Bullet) -- (0,\Height/5);
    \draw[dimen] (\Diam,-\Bullet) -- (\Diam,\Height/5); %---diameter---
    \draw[arrow,<->] (0,\Height/5.5) -- (\Diam,\Height/5.5) node[caption]{$\diameter$\pgfmathparse{\Dia}\pgfmathresult};
    %---
    \ifthenelse{\equal{\Dtype}{coax}}{
    \draw[arrow,<->] (\Diam/2 - \FCD/2, -\Height + 3/\Scale) -- (\Diam/2 + \FCD/2, -\Height + 3/\Scale) node[caption,anchor=north]{\small $\diameter$\pgfmathparse{\Cdiam}\pgfmathresult};}{}
    %---
    \draw[dimen] (\Bullet,0) -- (-\Diam/5.5,0);
    \draw[dimen] (0,-\Height) -- (-\Diam/5.5,-\Height); %---height---
    \draw[arrow,<->] (-\Diam/6.0,0) -- (-\Diam/6.0,-\Height) node[caption]{\pgfmathparse{\Hei}\pgfmathresult};
    %---
    \draw[dimen] (\Diam/2-\GrooveInt/2,-\Height) -- (\Diam/2-\GrooveInt/2,-\Height-\Height/5);
    \draw[dimen] (\Diam/2+\GrooveInt/2,-\Height) -- (\Diam/2+\GrooveInt/2,-\Height-\Height/5); %---Groove inner D---
    \draw[arrow,<->] (\Diam/2-\GrooveInt/2,-\Height -\Height/5.5) -- (\Diam/2+\GrooveInt/2,-\Height - \Height/5.5) node[caption]{$\diameter$\pgfmathparse{\GrvIn}\pgfmathresult};
    %---
    \draw[dimen] (\Diam/2-\GrooveExt/2,-\Height) -- (\Diam/2-\GrooveExt/2,-\Height-\Height/3.5);
    \draw[dimen] (\Diam/2+\GrooveExt/2,-\Height) -- (\Diam/2+\GrooveExt/2,-\Height-\Height/3.5); %---Groove outer D---
    \draw[arrow,<->] (\Diam/2-\GrooveExt/2,-\Height -\Height/3.8) -- (\Diam/2+\GrooveExt/2,-\Height - \Height/3.8) node[caption]{$\diameter$\pgfmathparse{\GrvEx}\pgfmathresult};
    %---
    \ifthenelse{\equal{\Dtype}{coax}}{
    \draw[dimen] (\Diam-\Bullet,0) -- (\Diam+\Diam/5,0);
    \draw[dimen] (\Diam,-\Bullet) -- (\Diam+\Diam/5,-\Bullet);
    \draw[arrow,->] (\Diam+\Diam/5.5,-1.5*\Bullet) -- (\Diam+\Diam/5.5,0); 
    \draw[dimen] (\Diam+\Diam/5.5,-1.3*\Bullet) node[anchor=west,caption]{$\pgfmathparse{\Bult}\pgfmathresult\times45\degree$};}{} %Bulletize
    %---
    \draw[dimen] (\Diam/2 +\GrooveExt/2,-\Height+\WO) -- (\Diam/2+\GrooveInt*1.1,-\Height+\WO);
    \draw[arrow,<->] (\Diam/2+\GrooveInt,-\Height+\WO) -- (\Diam/2+\GrooveInt,-\Height) node[caption]{\pgfmathparse{\Gdt}\pgfmathresult};
    %---
    \ifthenelse{\equal{\Dtype}{coax}}{
    \draw[dimen] (\Diam/2+\FCD/2, -\Height+\CDepth) -- (\Diam+\Diam/5,-\Height+\CDepth);
    \draw[dimen] (\Diam,-\Height) -- (\Diam+\Diam/5,-\Height);
    \draw[arrow,<->] (\Diam+\Diam/5.5,-\Height+\CDepth) -- (\Diam+\Diam/5.5,-\Height) node[caption]{\pgfmathparse{\Cdepth}\pgfmathresult};}{}
    \ifthenelse{\boolean{show_legendbox}}
    {
    %--- INFO BOX
    \newcommand\LX{\Diam/2.5}           % Legend box horizontal size
    \newcommand\LY{\LX/2}               % Legend box vertical size
    \ifthenelse{\equal{\Dtype}{coax}}{
    \newcommand\Xa{\Diam*1.4}}{}           % Legend box horizontal position if coax
    \ifthenelse{\equal{\Dtype}{flat}}{
      \newcommand\Xa{\Diam*1.15}}{}           % Legend box horizontal position if flat
    \newcommand\Ya{0/\Scale}            % Legend box vertical position

    \filldraw[left color=green!10, right color=green!10, draw=black] (\Xa, \Ya) rectangle (\Xa+\LX, \Ya-\LY);
    \draw (\Xa+\LX/2, \Ya) node[anchor=north]{\Large $\Name$};
    \draw (\Xa+\LX/2, \Ya-\LY/4) node[anchor=north]{\Large $\Crystal$};
    \draw (\Xa+\LX/2, \Ya-\LY/1.8) node[anchor=north]{\large $\mathcal{C}_{HEAD}=~\HEAD\times10^{10}~cm^{-3}$};
    \draw (\Xa+\LX/2, \Ya-\LY) node[anchor=south]{\large $\mathcal{C}_{TAIL}=~\TAIL\times10^{10}~cm^{-3}$};
    %---
    }{}

  %3D miniature
  % \ifthenelse{\equal{\Dtype}{coax}}{\draw (0,0) node{COAX};}{}

  \end{tikzpicture}
}

\end{document}
